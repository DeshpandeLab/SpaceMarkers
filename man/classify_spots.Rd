% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/hdutils.R
\name{classify_spots}
\alias{classify_spots}
\title{Classify spots into interacting / non-interacting pattern regions}
\usage{
classify_spots(pat_hotspots, influence_hotspots, patternpair = NULL)
}
\arguments{
\item{pat_hotspots}{Data frame of pattern hotspots with columns:
\code{x}, \code{y}, \code{barcode}, and one or more pattern columns.}

\item{influence_hotspots}{Data frame of influence hotspots with the same
dimensions and pattern columns as \code{pat_hotspots}. If \code{NULL},
a symmetric (undirected) classification is returned. Default: \code{NULL}.}

\item{patternpair}{Character vector of length 2 giving the two pattern
names to classify, e.g. \code{c("Epi", "Plasma")}. If \code{NULL} and
more than 2 patterns are present, an error is thrown.}
}
\value{
A data frame of region labels:
\itemize{
\item If \code{influence_hotspots} is \code{NULL}: one column named
\code{"<pattern1>_<pattern2>"} with values
\code{"Interacting"}, \code{pattern1}, \code{pattern2}, or \code{NA}.
\item Otherwise: two columns
\code{"<pattern1>_near_<pattern2>"} and
\code{"<pattern2>_near_<pattern1>"} with values
\code{"Interacting"}, \code{pattern1} / \code{pattern2}, or \code{NA}.
}
}
\description{
Given pattern hotspots and their corresponding influence hotspots,
classify each spot into:
\itemize{
\item undirected interacting region (when \code{influence_hotspots = NULL}), or
\item directed regions for each pattern pair (e.g. \code{"Epi_near_Plasma"},
\code{"Plasma_near_Epi"}).
}

The function expects identical dimensions and pattern columns for
\code{pat_hotspots} and \code{influence_hotspots}. When only
\code{pat_hotspots} is provided, a single undirected column is created.
}
\examples{
\dontrun{
pat_hotspots <- data.frame(
  x = 1:5,
  y = 1:5,
  barcode = paste0("Spot", 1:5),
  Epi    = c(1, NA, 1, NA, NA),
  Plasma = c(NA, 1, NA, 1, NA)
)

influence_hotspots <- data.frame(
  x = 1:5,
  y = 1:5,
  barcode = paste0("Spot", 1:5),
  Epi    = c(NA, 1, 1, NA, NA),
  Plasma = c(1, NA, NA, 1, 1)
)

# Directed classification
cls <- classify_spots(
  pat_hotspots       = pat_hotspots,
  influence_hotspots = influence_hotspots,
  patternpair        = c("Epi","Plasma")
)

# Undirected (influence_hotspots = NULL)
und <- classify_spots(
  pat_hotspots       = pat_hotspots,
  influence_hotspots = NULL,
  patternpair        = c("Epi","Plasma")
)
}
}
