% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/multisample.R
\name{get_all_lr_interactions}
\alias{get_all_lr_interactions}
\title{Assemble ligand receptor interaction table}
\usage{
get_all_lr_interactions(
  lr_scores,
  ligand_scores,
  receptor_scores,
  lrpairs,
  ligand_col = "ligand",
  receptor_col = "receptor",
  name_split_token = "_to_",
  ligand_near_token = "_near_",
  na_replace = 0
)
}
\arguments{
\item{lr_scores}{Matrix or named list of matrices with LR scores. Rows are
interaction IDs and columns are Source_to_Target combinations.}

\item{ligand_scores}{Matrix or named list of matrices with ligand-only
scores. Rows are interaction IDs and columns are Source_near_Target labels.}

\item{receptor_scores}{Matrix or named list of matrices with receptor-only
scores. Rows are interaction IDs and columns are target cell types.}

\item{lrpairs}{Data.frame with row names equal to interaction IDs and
annotation columns for ligand and receptor genes.}

\item{ligand_col}{Character. Column name in lrpairs containing ligand genes.}

\item{receptor_col}{Character. Column name in lrpairs containing receptor genes.}

\item{name_split_token}{Character. Token used to split Source_to_Target
column names in lr_scores.}

\item{ligand_near_token}{Character. Token used to construct Source_near_Target
column names in ligand_scores.}

\item{na_replace}{Numeric. Value used to replace NA scores.}
}
\value{
A data.frame where each row is one interaction for one
Source_to_Target column and one sample. Columns include ligand, ligand_score,
receptor, receptor_score, interaction, score, source_cell_type,
target_cell_type, source_to_target, and sample.
}
\description{
Combine LR scores, ligand-only scores, and receptor-only scores into a single
long-format data.frame for downstream plotting. Works with either single
matrices or named lists of matrices (one per sample).
}
\examples{
\dontrun{
# Toy example with a single "sample"
set.seed(1)

# interaction IDs
ints <- c("INT1","INT2")

# LR scores: rows = interactions, cols = "Source_to_Target"
lr_mat <- matrix(runif(4), nrow = 2,
                 dimnames = list(ints, c("Epi_to_Tcell","Fibro_to_Tcell")))

# ligand scores: rows = interactions, cols = "Source_near_Target"
lig_mat <- matrix(runif(4), nrow = 2,
                  dimnames = list(ints, c("Epi_near_Tcell","Fibro_near_Tcell")))

# receptor scores: rows = interactions, cols = target cell types
rec_mat <- matrix(runif(2), nrow = 2,
                  dimnames = list(ints, "Tcell"))

# ligand/receptor annotation
lrpairs <- data.frame(
  ligand   = c("LIG1","LIG2"),
  receptor = c("REC1","REC2"),
  row.names = ints
)

df_long <- get_all_lr_interactions(
  lr_scores       = lr_mat,
  ligand_scores   = lig_mat,
  receptor_scores = rec_mat,
  lrpairs         = lrpairs
)
head(df_long)
}

}
