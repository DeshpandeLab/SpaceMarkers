% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils.R
\name{plot_interaction_dotplot}
\alias{plot_interaction_dotplot}
\title{Dot plot of gene expression summary across interaction groups}
\usage{
plot_interaction_dotplot(
  meta_df,
  meta_col = NULL,
  x_var = meta_col,
  y_var = "gene_symbol",
  title = "Dot Plot",
  xlab = meta_col,
  ylab = "Gene Symbol",
  x_text_angle = 90,
  x_text_hjust = 1,
  x_text_size = 12,
  y_text_size = 12,
  title_size = 14,
  size_name = "Percentage Expressed",
  fill_name = "Avg Expression",
  fill_colors = NULL,
  size_var = "pct.expr",
  fill_var = "avg.expr",
  order = "both",
  user_order_rows = NULL,
  user_order_cols = NULL,
  dot_shape = 21,
  border_color = "black",
  stroke = 0,
  clust_method = "ward.D2"
)
}
\arguments{
\item{meta_df}{Data frame containing per-group gene summaries. Must include
at least the columns:
\itemize{
\item \code{meta_col} (default \code{NULL}),
\item \code{y_var} (default \code{"gene_symbol"}),
\item \code{"pct.expr"} and \code{"avg.expr"}.
}}

\item{meta_col}{Character, metadata column representing the main grouping
(usually the same as \code{x_var}). Default: \code{NULL}.}

\item{x_var}{Character, column to use on the x-axis (group labels).
Default: \code{meta_col}.}

\item{y_var}{Character, column to use on the y-axis (gene labels).
Default: \code{"gene_symbol"}.}

\item{title, xlab, ylab}{Plot title and axis labels.}

\item{x_text_angle, x_text_hjust, x_text_size}{Formatting of x-axis text.}

\item{y_text_size, title_size}{Font sizes for y-axis text and title.}

\item{size_name, fill_name}{Legend titles for size (percentage) and fill
(average expression).}

\item{fill_colors}{Optional vector of colors for a continuous gradient.
If \code{NULL}, a whiteâ†’red gradient is generated with \pkg{circlize}.}

\item{size_var, fill_var}{Column names in \code{meta_df} for size and fill
aesthetics. Defaults: \code{"pct.expr"} and \code{"avg.expr"}.}

\item{order}{Character; ordering strategy for rows/cols. One of
\code{"both"}, \code{"row"}, \code{"column"}, or \code{NULL}. If \code{NULL}, user must supply
both \code{user_order_rows} and \code{user_order_cols}.}

\item{user_order_rows, user_order_cols}{Optional explicit orderings for the
y- and x-axis when \code{order = NULL} or partially overridden.}

\item{dot_shape, border_color, stroke}{Aesthetics for the points.}

\item{clust_method}{Clustering method passed to \code{hclust} when rows/cols
are ordered by hierarchical clustering. Default: \code{"ward.D2"}.}
}
\value{
A \code{ggplot} object.
}
\description{
Create a Seurat-style dot plot where:
\itemize{
\item the x-axis represents interaction / group levels (e.g. \code{"Stom"}, \code{"Interacting"}, \code{"B"}),
\item the y-axis represents genes (or any feature),
\item dot size encodes percentage of cells expressing the gene,
\item dot fill encodes average expression.
}

The function can optionally cluster rows/columns using hierarchical clustering
on the average-expression matrix, or respect a user-specified ordering. If
an \code{"Interacting"} level is present on the x-axis, it is automatically
centered between the other two levels (if there are exactly two others).
}
\examples{
\dontrun{
# Suppose `avg_df` was created by create_avg_exp_df() and then subset:
# avg_df has columns: NULL, gene_symbol, pct.expr, avg.expr

p <- plot_interaction_dotplot(
  meta_df = avg_df,
  meta_col = NULL,
  x_var    = NULL,
  y_var    = "gene_symbol",
  title    = "Senescence gene panel by subClone",
  order    = "both"
)
print(p)
}

}
