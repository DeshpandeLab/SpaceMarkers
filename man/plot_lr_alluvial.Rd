% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/multisample.R
\name{plot_lr_alluvial}
\alias{plot_lr_alluvial}
\title{Plot ligand receptor alluvial diagram}
\usage{
plot_lr_alluvial(
  df,
  sample_groups = NULL,
  col_score = "score",
  col_source = "source_cell_type",
  col_target = "target_cell_type",
  col_ligand = "ligand",
  col_receptor = "receptor",
  col_sample = "sample",
  title = NULL,
  min_score = 0,
  top_k_per_pair = NULL,
  alpha = 0.8,
  knot_pos = 0.4,
  label_size = 2.7,
  wrap_width = 12
)
}
\arguments{
\item{df}{Data.frame with score, source, target, ligand, receptor, and
optionally sample columns.}

\item{sample_groups}{Optional named vector that maps sample IDs to group
labels. Names must match the sample column values.}

\item{col_score}{Character. Column name for the interaction score.}

\item{col_source}{Character. Column name for the source cell type.}

\item{col_target}{Character. Column name for the target cell type.}

\item{col_ligand}{Character. Column name for the ligand.}

\item{col_receptor}{Character. Column name for the receptor.}

\item{col_sample}{Character. Column name for the sample ID.}

\item{title}{Optional plot title. If NULL, a default title is used.}

\item{min_score}{Numeric. Minimum score to keep.}

\item{top_k_per_pair}{Optional integer. If not NULL, keep at most this many
top rows per source and target pair.}

\item{alpha}{Numeric between 0 and 1. Alpha transparency for flows.}

\item{knot_pos}{Numeric between 0 and 1. Knot position along the flow.}

\item{label_size}{Numeric. Text size for node labels.}

\item{wrap_width}{Integer or NULL. If not NULL, wrap long labels to this width.}
}
\value{
A ggplot object.
}
\description{
Make an alluvial (Sankey style) plot showing flows from source cell type
to ligand, receptor, and target cell type. Flow width is proportional to an
interaction score. Flows can be colored by sample group or by the
source to target pair.
}
\examples{
\dontrun{
if (requireNamespace("ggplot2", quietly = TRUE) &&
    requireNamespace("ggalluvial", quietly = TRUE) &&
    requireNamespace("RColorBrewer", quietly = TRUE) &&
    requireNamespace("circlize", quietly = TRUE)) {

  set.seed(123)
  top_normal <- data.frame(
    score            = runif(20, 0.1, 1),
    source_cell_type = sample(c("Keratinocyte", "Fibroblast"), 20, TRUE),
    target_cell_type = sample(c("T cell", "Macrophage"), 20, TRUE),
    ligand           = sample(c("CXCL12", "CCL5", "TNF"), 20, TRUE),
    receptor         = sample(c("CXCR4", "CCR5", "TNFRSF1A"), 20, TRUE),
    sample           = sample(c("NS_1", "NS_2", "VU_1", "VU_2"), 20, TRUE),
    stringsAsFactors = FALSE
  )

  # Sample to group mapping
  sample_groups <- c(
    NS_1 = "Normal skin",
    NS_2 = "Normal skin",
    VU_1 = "Venous ulcer",
    VU_2 = "Venous ulcer"
  )

  # Basic usage with grouping and custom title
  p <- plot_lr_alluvial(
    df             = top_normal,
    sample_groups  = sample_groups,
    top_k_per_pair = NULL,
    title = "Top Normal LR Interactions"
  )
  print(p)
}
}

}
