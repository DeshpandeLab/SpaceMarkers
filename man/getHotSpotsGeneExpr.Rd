% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plotMultiWayViolin.R
\name{getHotSpotsGeneExpr}
\alias{getHotSpotsGeneExpr}
\title{Join Spot-Level Gene Expression to Hotspot Labels}
\usage{
getHotSpotsGeneExpr(hotspots, spCounts, gene = NULL, ...)
}
\arguments{
\item{hotspots}{\code{data.frame} with a \code{"barcode"} column (if absent, row names
are used to construct one) and any number of hotspot label columns.}

\item{spCounts}{A numeric matrix or a sparse \code{Matrix} (genes x barcodes)
containing expression values.}

\item{gene}{Character vector of gene names (row names of \code{spCounts}) to
extract. If \code{NULL}, all genes are used.}

\item{...}{Ignored; reserved for compatibility.}
}
\value{
A \code{data.frame} with columns \code{gene_name}, \code{barcode}, \code{gene_exp} and
all columns from \code{hotspots}.
}
\description{
Builds a long table of \verb{(gene_name, barcode, gene_exp)} from \code{spCounts} and
joins hotspot columns from \code{hotspots} by \code{barcode}. Intended as input for
plotting functions (e.g., \code{\link[=plotMultiWayViolin]{plotMultiWayViolin()}}).
}
\details{
If \code{spCounts} is a sparse \code{Matrix}, only \strong{non-zero} entries are returned
(via \code{Matrix::summary}). If you require explicit zeros, convert the matrix to
dense first (e.g., \code{as.matrix(spCounts)}), understanding this can be memory
intensive.
}
\examples{
set.seed(1)
m <- matrix(rpois(12, 1), nrow = 3,
            dimnames = list(c("GeneA","GeneB","GeneC"),
                            paste0("bc",1:4)))
hs <- data.frame(barcode = paste0("bc",1:4),
                 A = c("A", NA, "A", NA),
                 B = c(NA, "B", NA, "B"))
ge <- getHotSpotsGeneExpr(hotspots = hs, m, gene = "GeneA")
print(ge)

}
\seealso{
\code{\link[=plotMultiWayViolin]{plotMultiWayViolin()}}
}
