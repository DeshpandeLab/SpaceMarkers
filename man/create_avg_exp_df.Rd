% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils.R
\name{create_avg_exp_df}
\alias{create_avg_exp_df}
\title{Average & detection by group for a gene set (NA-safe on meta_col)}
\usage{
create_avg_exp_df(counts, metadata, features, meta_col, barcode_col = NULL)
}
\arguments{
\item{counts}{Matrix or dgCMatrix: genes (rows) Ã— cells (cols).}

\item{metadata}{Data frame with per-cell metadata. Must include \code{meta_col}
and either have barcodes as rownames or a column named in \code{barcode_col}.}

\item{features}{Character vector of gene symbols to include.}

\item{meta_col}{Name of the metadata column used to group cells (e.g., "celltype").}

\item{barcode_col}{Optional column name in \code{metadata} holding cell barcodes.
If NULL, rownames(metadata) are used as barcodes.}
}
\value{
data.frame with columns: meta_col, gene_symbol, pct.expr, avg.expr
}
\description{
Average & detection by group for a gene set (NA-safe on meta_col)
}
\examples{
\dontrun{
# Example: average expression by SpaceMarkers interaction region

# Suppose:
#   - spCounts is a genes x barcodes count matrix
#   - spHotspots_all is a metadata data.frame with a "barcode" column
#     and an interaction-region column "Epi_Plasma"
#   - df is a data.frame with a column "Gene" containing gene symbols of interest

meta_col <- "Epi_Plasma"

exp_df <- create_avg_exp_df(
  counts      = spCounts,
  metadata    = spHotspots_all,
  features    = df$Gene,
  meta_col    = meta_col,
  barcode_col = "barcode"
)

head(exp_df)
}
}
